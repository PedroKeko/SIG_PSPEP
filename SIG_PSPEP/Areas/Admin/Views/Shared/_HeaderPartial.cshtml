<style>
    .navbar-header {
        background: linear-gradient(to bottom left, black, #021324);
    }

    #badgeTotalMensagens {
        font-size: 10px;
        padding: 4px 4px;
    }

</style>

<header class="topbar" data-navbarbg="skin5">
    <nav class="navbar top-navbar navbar-expand-md navbar-dark">

        <div class="navbar-header navbar-header-color" data-logobg="skin5">
            <a class="navbar-brand" asp-controller="Home" asp-action="Index" asp-area="Admin">
                <b class="logo-icon ps-2">
                    <img src="~/assets/images/logo-icon.png"
                         alt="homepage"
                         class="light-logo"
                         width="25" />
                </b>
                <span class="logo-text ms-2 fw-bold gradient-text">
                    SGI-PSPEP
                </span>
            </a>
            <a class="nav-toggler waves-effect waves-light d-block d-md-none"
               href="javascript:void(0)">
                <i class="ti-menu ti-close"></i>
            </a>
        </div>

        <div class="navbar-collapse collapse"
             id="navbarSupportedContent"
             data-navbarbg="skin5">
            <span class="small-star">★</span>
            <ul class="navbar-nav float-start me-auto">
                <li class="nav-item d-none d-lg-block">
                    <a class="nav-link sidebartoggler waves-effect waves-light"
                       href="javascript:void(0)"
                       data-sidebartype="mini-sidebar">
                        <i class="mdi mdi-menu font-24"></i>
                    </a>
                </li>
                <li class="nav-item search-box">
                    <a class="nav-link waves-effect waves-dark"
                       href="javascript:void(0)">
                        <i class="mdi mdi-magnify fs-4"></i>
                    </a>
                    <form class="app-search position-absolute">
                        <input type="text"
                               class="form-control"
                               placeholder="Search &amp; enter" />
                        <a class="srh-btn"><i class="mdi mdi-window-close"></i></a>
                    </form>
                </li>
                <li class="nav-item d-none d-lg-block">
                    <a class="nav-link sidebartoggler fw-bold waves-effect waves-light">
                        Área Administrativa do SIG-PSPEP
                    </a>
                </li>
            </ul>
            <ul class="navbar-nav float-end">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle"
                       href="#"
                       id="navbarDropdown"
                       role="button"
                       data-bs-toggle="dropdown"
                       aria-expanded="false">
                        <i class="mdi mdi-bell font-24"></i>
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <li><a class="dropdown-item" href="#">Action</a></li>
                        <li><a class="dropdown-item" href="#">Another action</a></li>
                        <li><hr class="dropdown-divider" /></li>
                        <li>
                            <a class="dropdown-item" href="#">Something else here</a>
                        </li>
                    </ul>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle waves-effect waves-dark position-relative"
                       href="#"
                       id="2"
                       role="button"
                       data-bs-toggle="dropdown"
                       aria-expanded="false">
                        <i class="font-24 mdi mdi-comment-processing"></i>

                        <span id="badgeTotalMensagens"
                              class="badge rounded-pill bg-danger"
                              style="position: absolute; top: 12px; right: 7px; font-size: 10px; padding: 1px 5px;">
                            0
                        </span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end mailbox animated bounceInDown" aria-labelledby="2">
                        <li>
                            <div class="drop-title">
                                Mensagens
                            </div>
                        </li>
                        <li>
                            <ul class="list-style-none" id="notificacoesMensagens">
                                <!-- mensagens via AJAX -->
                            </ul>
                        </li>
                    </ul>
                </li>

                <partial name="_LoginPartial" />
            </ul>
        </div>
    </nav>
</header>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Carregar notificações via PartialView
        fetch('/Reportes/UltimasMensagens')
            .then(res => res.text())
            .then(html => {
                document.getElementById('notificacoesMensagens').innerHTML = html;
            });

        // Obter total de mensagens e mostrar badge
        fetch('/Reportes/TotalMensagens')
            .then(res => res.json())
            .then(total => {
                const badge = document.getElementById('badgeTotalMensagens');

                if (total > 0) {
                    badge.textContent = total;
                    badge.style.display = 'inline';
                } else {
                    // Remover o badge do DOM
                    badge.remove();
                }
            });
    });
</script>



